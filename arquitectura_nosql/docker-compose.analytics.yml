version: '3.9'

services:
  riak:
    image: basho/riak-kv
    container_name: riak_db
    ports:
      - "8087:8087"   # Protocol Buffers (no lo usamos ahora, pero da igual)
      - "8098:8098"   # HTTP API
    # Para que el bucket 'eventos' est√© disponible directamente con tipo default

  analytics:
    build: ./analytics
    container_name: analytics_service
    environment:
      - RIAK_HOST=riak
      - RIAK_PORT=8098
    command: uvicorn app:app --host 0.0.0.0 --port 8003
    ports:
      - "8003:8003"
    depends_on:
      - riak
